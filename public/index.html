<!doctype html>
<html lang="es" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NeuralChat</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;1,9..40,300&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/tokyo-night-dark.min.css"
      id="hljs-theme"
    />
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.6/marked.min.js"></script>
  </head>

  <body>
    <div id="app">
      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SIDEBAR ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <aside id="sidebar">
        <div class="sidebar-header">
          <div class="logo">
            <div class="logo-icon">‚ö°</div>
            NeuralChat
          </div>
        </div>

        <button id="btn-new-chat" onclick="newConversation()">
          <svg
            width="14"
            height="14"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2.5"
          >
            <line x1="12" y1="5" x2="12" y2="19" />
            <line x1="5" y1="12" x2="19" y2="12" />
          </svg>
          Nueva conversaci√≥n
        </button>

        <!-- Search -->
        <div class="conv-search-wrap">
          <svg
            width="13"
            height="13"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            class="search-icon"
          >
            <circle cx="11" cy="11" r="8" />
            <line x1="21" y1="21" x2="16.65" y2="16.65" />
          </svg>
          <input
            id="conv-search"
            type="text"
            placeholder="Buscar conversaciones..."
            oninput="onSearchInput(this.value)"
          />
          <button
            class="search-clear"
            onclick="clearSearch()"
            id="search-clear-btn"
            style="display: none"
            title="Limpiar"
          >
            ‚úï
          </button>
        </div>

        <div class="sidebar-section-label">Conversaciones</div>

        <div id="conversations-list">
          <div class="empty-conversations">
            No hay conversaciones a√∫n.<br />Empieza una nueva.
          </div>
        </div>

        <div class="sidebar-footer">
          <button
            class="sidebar-footer-btn settings-btn"
            onclick="openSettings()"
          >
            <svg
              width="14"
              height="14"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="3" />
              <path
                d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"
              />
            </svg>
            API Keys &amp; Modelos
            <span id="keys-indicator" class="keys-indicator"></span>
          </button>
          <button class="sidebar-footer-btn" onclick="openExport()">
            <svg
              width="14"
              height="14"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" />
              <polyline points="7 10 12 15 17 10" />
              <line x1="12" y1="15" x2="12" y2="3" />
            </svg>
            Exportar conversaci√≥n
          </button>
          <button class="sidebar-footer-btn" onclick="toggleTheme()">
            <svg
              width="14"
              height="14"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              id="theme-icon"
            >
              <circle cx="12" cy="12" r="5" />
              <line x1="12" y1="1" x2="12" y2="3" />
              <line x1="12" y1="21" x2="12" y2="23" />
              <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
              <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
              <line x1="1" y1="12" x2="3" y2="12" />
              <line x1="21" y1="12" x2="23" y2="12" />
              <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
              <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
            </svg>
            <span id="theme-label">Modo claro</span>
          </button>
        </div>
      </aside>

      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MAIN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <div id="main">
        <header id="header">
          <button
            id="btn-sidebar-toggle"
            onclick="toggleSidebar()"
            title="Alternar sidebar (Ctrl+B)"
          >
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <line x1="3" y1="6" x2="21" y2="6" />
              <line x1="3" y1="12" x2="21" y2="12" />
              <line x1="3" y1="18" x2="21" y2="18" />
            </svg>
          </button>

          <span id="chat-title-header">Nueva conversaci√≥n</span>

          <div class="header-controls">
            <div class="svc-dropdown-wrap">
              <button
                id="service-selector"
                onclick="toggleServiceDropdown(event)"
                title="Seleccionar servicio AI"
                aria-haspopup="listbox"
              >
                <svg
                  width="11"
                  height="11"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="12" cy="12" r="3" />
                  <path
                    d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"
                  />
                </svg>
                <span id="service-label">Auto</span>
                <svg
                  class="svc-chevron"
                  width="10"
                  height="10"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2.5"
                >
                  <polyline points="6 9 12 15 18 9" />
                </svg>
                <span id="current-service-badge" class="service-badge"
                  >AUTO</span
                >
              </button>
              <div id="service-dropdown" class="svc-dropdown" role="listbox">
                <!-- populated by JS -->
              </div>
            </div>

            <button
              class="icon-btn"
              onclick="toggleSystemPanel()"
              title="System prompt (Ctrl+/)"
              id="btn-system"
            >
              <svg
                width="15"
                height="15"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <rect x="3" y="3" width="18" height="18" rx="2" />
                <line x1="8" y1="12" x2="16" y2="12" />
                <line x1="8" y1="8" x2="16" y2="8" />
                <line x1="8" y1="16" x2="12" y2="16" />
              </svg>
            </button>

            <button
              class="icon-btn"
              onclick="openSettings()"
              title="Configurar API keys (Ctrl+,)"
            >
              <svg
                width="15"
                height="15"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="12" cy="12" r="3" />
                <path
                  d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"
                />
              </svg>
            </button>

            <button
              class="icon-btn"
              onclick="clearCurrentConversation()"
              title="Limpiar chat"
            >
              <svg
                width="15"
                height="15"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <polyline points="3 6 5 6 21 6" />
                <path d="M19 6l-1 14a2 2 0 01-2 2H8a2 2 0 01-2-2L5 6" />
                <path d="M10 11v6M14 11v6M9 6V4h6v2" />
              </svg>
            </button>
          </div>
        </header>

        <!-- No API keys banner -->
        <div id="no-keys-banner" class="no-keys-banner" style="display: none">
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
            <path d="M7 11V7a5 5 0 0110 0v4" />
          </svg>
          <span>Configura tus API keys para empezar a chatear</span>
          <button onclick="openSettings()">Configurar ahora ‚Üí</button>
        </div>

        <div id="messages-container">
          <div id="messages-inner">
            <div id="welcome">
              <div class="welcome-logo">‚ö°</div>
              <div class="welcome-title">NeuralChat</div>
              <div class="welcome-sub">
                Chat profesional con m√∫ltiples modelos de IA. Env√≠a texto,
                im√°genes, PDFs y cualquier tipo de archivo.
              </div>
              <div class="welcome-chips">
                <button
                  class="welcome-chip"
                  onclick="
                    useChip('Expl√≠came c√≥mo funciona la IA en t√©rminos simples')
                  "
                >
                  ¬øC√≥mo funciona la IA?
                </button>
                <button
                  class="welcome-chip"
                  onclick="
                    useChip(
                      'Escribe un script en Python para analizar datos CSV',
                    )
                  "
                >
                  Script Python CSV
                </button>
                <button
                  class="welcome-chip"
                  onclick="useChip('Resume los puntos clave de este documento')"
                >
                  Resumir documento
                </button>
                <button
                  class="welcome-chip"
                  onclick="
                    useChip(
                      '¬øCu√°les son las mejores pr√°cticas en desarrollo web?',
                    )
                  "
                >
                  Mejores pr√°cticas web
                </button>
                <button
                  class="welcome-chip"
                  onclick="
                    useChip(
                      'Traduce este texto al ingl√©s manteniendo el tono original',
                    )
                  "
                >
                  Traductor
                </button>
                <button
                  class="welcome-chip"
                  onclick="useChip('Analiza este c√≥digo y sugiere mejoras')"
                >
                  Revisar c√≥digo
                </button>
              </div>
            </div>
          </div>
        </div>

        <div id="input-area">
          <div id="input-inner">
            <div id="file-previews"></div>
            <div class="textarea-wrap" id="textarea-wrap">
              <textarea
                id="msg-input"
                placeholder="Escribe un mensaje‚Ä¶ (Enter para enviar, Shift+Enter para nueva l√≠nea)"
                rows="1"
                oninput="autoResize(this)"
                onkeydown="handleKeydown(event)"
                disabled
              ></textarea>
              <div class="input-actions">
                <label
                  class="input-action-btn"
                  title="Adjuntar archivo"
                  style="cursor: pointer"
                >
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path
                      d="M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 015.66 5.66l-9.2 9.19a2 2 0 01-2.83-2.83l8.49-8.48"
                    />
                  </svg>
                  <input
                    type="file"
                    id="file-input"
                    multiple
                    style="display: none"
                    onchange="handleFileInput(event)"
                  />
                </label>
                <button
                  id="btn-send"
                  onclick="sendMessage()"
                  title="Enviar (Enter)"
                  disabled
                >
                  <svg
                    width="15"
                    height="15"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2.5"
                  >
                    <line x1="22" y1="2" x2="11" y2="13" />
                    <polygon points="22 2 15 22 11 13 2 9 22 2" />
                  </svg>
                </button>
                <button
                  id="btn-stop"
                  onclick="stopStreaming()"
                  title="Cancelar (Esc)"
                  style="display: none"
                >
                  <svg
                    width="14"
                    height="14"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                  >
                    <rect x="4" y="4" width="16" height="16" rx="2" />
                  </svg>
                </button>
              </div>
            </div>
            <div class="input-hint">
              <span
                >Enter para enviar ¬∑ Shift+Enter nueva l√≠nea ¬∑ Ctrl+K nueva
                conversaci√≥n ¬∑ Ctrl+, configuraci√≥n</span
              >
            </div>
          </div>
        </div>
      </div>
      <!-- /main -->
    </div>
    <!-- /app -->

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SETTINGS PANEL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="settings-panel">
      <div class="settings-overlay" onclick="closeSettings()"></div>
      <div class="settings-modal">
        <div class="settings-header">
          <div class="settings-title">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
              <path d="M7 11V7a5 5 0 0110 0v4" />
            </svg>
            API Keys &amp; Configuraci√≥n
          </div>
          <button class="icon-btn" onclick="closeSettings()">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <line x1="18" y1="6" x2="6" y2="18" />
              <line x1="6" y1="6" x2="18" y2="18" />
            </svg>
          </button>
        </div>

        <div class="settings-body">
          <p class="settings-desc">
            Tus API keys se guardan en el navegador (localStorage) y se env√≠an
            de forma segura en cada petici√≥n. Nunca se almacenan en el servidor.
          </p>

          <!-- GROQ -->
          <div class="service-config-card">
            <div class="service-config-header">
              <div class="service-config-name">
                <span class="key-status-dot inactive" id="status-groq"></span>
                <span class="service-config-icon">‚ö°</span>
                <span>Groq</span>
                <a
                  href="https://console.groq.com/keys"
                  target="_blank"
                  class="get-key-link"
                  >Obtener key ‚Üí</a
                >
              </div>
            </div>
            <div class="service-config-fields">
              <div class="key-input-wrap">
                <input
                  type="password"
                  id="key-groq"
                  placeholder="gsk_..."
                  class="key-input"
                  autocomplete="off"
                  spellcheck="false"
                />
                <button
                  class="key-toggle-btn"
                  id="toggle-groq"
                  onclick="toggleKeyVisibility('groq')"
                  title="Mostrar/ocultar"
                >
                  <svg
                    width="14"
                    height="14"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                    <circle cx="12" cy="12" r="3" />
                  </svg>
                </button>
                <button
                  class="key-clear-btn"
                  onclick="clearKey('groq')"
                  title="Eliminar clave"
                >
                  ‚úï
                </button>
              </div>
              <div class="model-row">
                <input
                  type="text"
                  id="model-groq"
                  placeholder="moonshotai/kimi-k2-instruct-0905"
                  class="model-input"
                  list="groq-models"
                  value="moonshotai/kimi-k2-instruct-0905"
                />
                <datalist id="groq-models">
                  <option value="moonshotai/kimi-k2-instruct-0905" />
                  <option value="deepseek-r1-distill-llama-70b" />
                  <option value="llama-3.3-70b-versatile" />
                  <option value="llama3-70b-8192" />
                  <option value="llama3-8b-8192" />
                  <option value="mixtral-8x7b-32768" />
                  <option value="gemma2-9b-it" />
                </datalist>
                <button
                  class="load-models-btn"
                  id="load-models-groq"
                  onclick="loadModelsForService('groq')"
                >
                  Cargar
                </button>
              </div>
            </div>
          </div>

          <!-- CEREBRAS -->
          <div class="service-config-card">
            <div class="service-config-header">
              <div class="service-config-name">
                <span
                  class="key-status-dot inactive"
                  id="status-cerebras"
                ></span>
                <span class="service-config-icon">üß†</span>
                <span>Cerebras</span>
                <a
                  href="https://cloud.cerebras.ai/"
                  target="_blank"
                  class="get-key-link"
                  >Obtener key ‚Üí</a
                >
              </div>
            </div>
            <div class="service-config-fields">
              <div class="key-input-wrap">
                <input
                  type="password"
                  id="key-cerebras"
                  placeholder="csk_..."
                  class="key-input"
                  autocomplete="off"
                  spellcheck="false"
                />
                <button
                  class="key-toggle-btn"
                  id="toggle-cerebras"
                  onclick="toggleKeyVisibility('cerebras')"
                  title="Mostrar/ocultar"
                >
                  <svg
                    width="14"
                    height="14"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                    <circle cx="12" cy="12" r="3" />
                  </svg>
                </button>
                <button
                  class="key-clear-btn"
                  onclick="clearKey('cerebras')"
                  title="Eliminar clave"
                >
                  ‚úï
                </button>
              </div>
              <div class="model-row">
                <input
                  type="text"
                  id="model-cerebras"
                  placeholder="gpt-oss-120b"
                  class="model-input"
                  list="cerebras-models"
                  value="gpt-oss-120b"
                />
                <datalist id="cerebras-models">
                  <option value="gpt-oss-120b" />
                  <option value="llama3.1-8b" />
                  <option value="qwen-3-235b-a22b-instruct-2507" />
                </datalist>
                <button
                  class="load-models-btn"
                  id="load-models-cerebras"
                  onclick="loadModelsForService('cerebras')"
                >
                  Cargar
                </button>
              </div>
            </div>
          </div>

          <!-- OPENROUTER -->
          <div class="service-config-card">
            <div class="service-config-header">
              <div class="service-config-name">
                <span
                  class="key-status-dot inactive"
                  id="status-openrouter"
                ></span>
                <span class="service-config-icon">üåê</span>
                <span>OpenRouter</span>
                <a
                  href="https://openrouter.ai/keys"
                  target="_blank"
                  class="get-key-link"
                  >Obtener key ‚Üí</a
                >
              </div>
            </div>
            <div class="service-config-fields">
              <div class="key-input-wrap">
                <input
                  type="password"
                  id="key-openrouter"
                  placeholder="sk-or-..."
                  class="key-input"
                  autocomplete="off"
                  spellcheck="false"
                />
                <button
                  class="key-toggle-btn"
                  id="toggle-openrouter"
                  onclick="toggleKeyVisibility('openrouter')"
                  title="Mostrar/ocultar"
                >
                  <svg
                    width="14"
                    height="14"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                    <circle cx="12" cy="12" r="3" />
                  </svg>
                </button>
                <button
                  class="key-clear-btn"
                  onclick="clearKey('openrouter')"
                  title="Eliminar clave"
                >
                  ‚úï
                </button>
              </div>
              <div class="model-row">
                <input
                  type="text"
                  id="model-openrouter"
                  placeholder="openrouter/auto"
                  class="model-input"
                  list="openrouter-models"
                  value="openrouter/auto"
                />
                <datalist id="openrouter-models">
                  <option value="openrouter/auto" />
                  <option value="google/gemini-2.0-flash-exp:free" />
                  <option value="meta-llama/llama-3.3-70b-instruct:free" />
                  <option value="deepseek/deepseek-r1:free" />
                  <option value="microsoft/phi-4:free" />
                  <option value="qwen/qwq-32b:free" />
                  <option value="google/gemma-3-27b-it:free" />
                </datalist>
                <button
                  class="load-models-btn"
                  id="load-models-openrouter"
                  onclick="loadModelsForService('openrouter')"
                >
                  Cargar
                </button>
              </div>
            </div>
          </div>

          <div class="settings-actions">
            <button class="panel-btn primary" onclick="saveSettings()">
              <svg
                width="14"
                height="14"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2.5"
              >
                <polyline points="20 6 9 17 4 12" />
              </svg>
              Guardar configuraci√≥n
            </button>
            <button class="panel-btn ghost" onclick="closeSettings()">
              Cancelar
            </button>
          </div>

          <div class="settings-security-note">
            <svg
              width="12"
              height="12"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
            </svg>
            Las API keys se guardan solo en tu navegador. El servidor las recibe
            en cada solicitud y no las almacena.
          </div>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SYSTEM PROMPT PANEL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="system-panel">
      <div class="panel-header">
        <span class="panel-title">‚öôÔ∏è System Prompt</span>
        <button class="icon-btn" onclick="toggleSystemPanel()">
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <line x1="18" y1="6" x2="6" y2="18" />
            <line x1="6" y1="6" x2="18" y2="18" />
          </svg>
        </button>
      </div>
      <div class="panel-content">
        <div>
          <div class="panel-label">Instrucciones del sistema</div>
          <textarea
            id="system-prompt-input"
            placeholder="Ej: Eres un asistente experto en Python..."
          ></textarea>
        </div>
        <div style="display: flex; gap: 8px; flex-wrap: wrap">
          <button class="panel-btn primary" onclick="saveSystemPrompt()">
            Guardar
          </button>
          <button class="panel-btn ghost" onclick="clearSystemPrompt()">
            Limpiar
          </button>
        </div>
        <div>
          <div class="panel-label">Plantillas</div>
          <div style="display: flex; flex-direction: column; gap: 6px">
            <button class="export-option" onclick="applyTemplate('python')">
              <span class="export-option-icon">üêç</span>
              <div class="export-option-info">
                <div class="title">Experto Python</div>
                <div class="sub">C√≥digo limpio y documentado</div>
              </div>
            </button>
            <button class="export-option" onclick="applyTemplate('coder')">
              <span class="export-option-icon">üíª</span>
              <div class="export-option-info">
                <div class="title">Ingeniero Senior</div>
                <div class="sub">C√≥digo production-ready</div>
              </div>
            </button>
            <button class="export-option" onclick="applyTemplate('translator')">
              <span class="export-option-icon">üåê</span>
              <div class="export-option-info">
                <div class="title">Traductor</div>
                <div class="sub">Traducci√≥n precisa y natural</div>
              </div>
            </button>
            <button class="export-option" onclick="applyTemplate('analyst')">
              <span class="export-option-icon">üìä</span>
              <div class="export-option-info">
                <div class="title">Analista de datos</div>
                <div class="sub">An√°lisis estructurado</div>
              </div>
            </button>
            <button class="export-option" onclick="applyTemplate('teacher')">
              <span class="export-option-icon">üéì</span>
              <div class="export-option-info">
                <div class="title">Profesor</div>
                <div class="sub">Explicaciones claras</div>
              </div>
            </button>
            <button class="export-option" onclick="applyTemplate('writer')">
              <span class="export-option-icon">‚úçÔ∏è</span>
              <div class="export-option-info">
                <div class="title">Escritor creativo</div>
                <div class="sub">Prosa elegante y creativa</div>
              </div>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê EXPORT PANEL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="export-panel">
      <div class="export-overlay" onclick="closeExport()"></div>
      <div class="export-modal">
        <div class="export-modal-header">
          <div class="export-modal-title">
            <div class="export-modal-icon">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" />
                <polyline points="7 10 12 15 17 10" />
                <line x1="12" y1="15" x2="12" y2="3" />
              </svg>
            </div>
            <div>
              <div class="export-modal-title-text">Exportar conversaci√≥n</div>
              <div class="export-modal-subtitle">
                Elige el formato de exportaci√≥n
              </div>
            </div>
          </div>
          <button class="export-close" onclick="closeExport()">
            <svg
              width="14"
              height="14"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <line x1="18" y1="6" x2="6" y2="18" />
              <line x1="6" y1="6" x2="18" y2="18" />
            </svg>
          </button>
        </div>
        <div class="export-options">
          <button class="export-option" onclick="exportAs('markdown')">
            <div class="export-option-icon-wrap export-icon-md">
              <svg
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.8"
              >
                <path
                  d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"
                />
                <polyline points="14 2 14 8 20 8" />
                <line x1="16" y1="13" x2="8" y2="13" />
                <line x1="16" y1="17" x2="8" y2="17" />
                <polyline points="10 9 9 9 8 9" />
              </svg>
            </div>
            <div class="export-option-info">
              <div class="export-option-name">
                Markdown <span class="export-option-ext">.md</span>
              </div>
              <div class="export-option-desc">
                Texto con formato, tablas y bloques de c√≥digo
              </div>
            </div>
            <svg
              class="export-option-arrow"
              width="14"
              height="14"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="9 18 15 12 9 6" />
            </svg>
          </button>

          <button class="export-option" onclick="exportAs('json')">
            <div class="export-option-icon-wrap export-icon-json">
              <svg
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.8"
              >
                <polyline points="16 18 22 12 16 6" />
                <polyline points="8 6 2 12 8 18" />
              </svg>
            </div>
            <div class="export-option-info">
              <div class="export-option-name">
                JSON <span class="export-option-ext">.json</span>
              </div>
              <div class="export-option-desc">
                Datos estructurados, servicios y metadatos
              </div>
            </div>
            <svg
              class="export-option-arrow"
              width="14"
              height="14"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="9 18 15 12 9 6" />
            </svg>
          </button>

          <button class="export-option" onclick="exportAs('txt')">
            <div class="export-option-icon-wrap export-icon-txt">
              <svg
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.8"
              >
                <path
                  d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"
                />
                <polyline points="14 2 14 8 20 8" />
                <line x1="8" y1="13" x2="16" y2="13" />
                <line x1="8" y1="17" x2="16" y2="17" />
                <line x1="8" y1="9" x2="11" y2="9" />
              </svg>
            </div>
            <div class="export-option-info">
              <div class="export-option-name">
                Texto plano <span class="export-option-ext">.txt</span>
              </div>
              <div class="export-option-desc">
                Sin formato, solo el contenido del chat
              </div>
            </div>
            <svg
              class="export-option-arrow"
              width="14"
              height="14"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="9 18 15 12 9 6" />
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- TOAST CONTAINER -->
    <div id="toast-container"></div>

    <script src="app.js"></script>
  </body>
</html>
